version: "3.3"

services:
  backend:
    image: 158670532160.dkr.ecr.us-east-1.amazonaws.com/ai-blogs-backend:latest
    container_name: ai-blogs-backend
    ports:
      - "4000:4000"
    environment:
      NODE_ENV: production
      MONGODB_URI: mongodb+srv://...
      PORT: 4000
      JWT_SECRET: "change-this-secret"
      APP_URL: http://YOUR-EC2-PUBLIC-IP:5174
      FRONTEND_URL: http://YOUR-EC2-PUBLIC-IP:5174
      RESEND_API_KEY: "..."
      FROM_EMAIL: "..."
      OPENAI_API_KEY: "..."
    restart: unless-stopped

  frontend:
    image: 158670532160.dkr.ecr.us-east-1.amazonaws.com/ai-blogs-frontend:latest
    container_name: ai-blogs-frontend
    ports:
      - "5174:80"
    environment:
      VITE_API_BASE: http://YOUR-EC2-PUBLIC-IP:4000/api
    depends_on:
      - backend
    restart: unless-stopped

networks:
  default:
    name: ai-blogs
    driver: bridge
